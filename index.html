<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" type="text/css" href="css/main.css">
    
    <!-- JavaScript file -->
    <script src="js/plugin.js"></script>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <style>
        #loading { display: block;
                   margin: auto;
                   width: 50%;
                }
        #container1 { display: none}
        #container2 { display: none}
    </style>
    <title>GenBank Query Results</title>
  </head>
    <body>
        <div id="loading">
            <h3 class="text-center" id="state_txt">Waiting for response...</h3>
            <object data="loading_gif.html" width="500" height="300"></object>
        </div>
        <div id="container1" class="container"> 

            <div class="page-header">
                <h1 class="text-center"> GENBANK RESULTS </h1>
            </div>
        
            <br>

            <div class="row">
                <div class="col-4">
                    <div class="btn-group">
                        <button type="button" id="results" class="btn btn-outline-primary bt-lg dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        GenBank Query Results
                        </button>
                        <div class="dropdown-menu">
                        </div>
                    </div>
                </div>

                <div class="col-8">
                    <div class="row">
                        <div class="col-6">
                            <label> 
                                MIN PCT COV: 
                                <input type="number" id="minPCT" step="0.01" max="100" min="0">
                            </label>
                        </div>
                        <div class="col-6">
                            <label> 
                                MIN Q COV:
                                <input type="number" id="minQ" step="0.01" max="100" min="0">
                            </label>
                    </div>
                    <div class="w-100"> </div>
                    <div class="col-6">
                        <label> 
                            Exact Matches Only
                            <input type="checkbox" id="myCheck">
                        </label>
                    </div>
                    <div class="col">
                        <button onclick="FilterDropDown()"> Filter </button>
                    </div>
                </div>
            </div>
        </div>

        <br>
        <br>

        <div id="container2" class="container"> 

            <div class="row">
                <div class="col-9 offset-3">
                    <table class="table table-hover table-bordered table-striped">
                        <tr class="d-flex">
                            <th class="col-3 tableheading">LINK:</th>
                            <td class="col-9"></td>
                        </tr>
                        <tr class="d-flex"> 
                            <th class="col-3 tableheading">LOCUS:</th>
                            <td class="col-9"></td>
                        </tr>
                        <tr class="d-flex">
                            <th class="col-3 tableheading">DEF:</th>
                            <td class="col-9"></td>
                        </tr>
                        <tr class="d-flex">
                            <th class="col-3 tableheading">ORGANISM:</th>
                            <td class="col-9"></td>
                        </tr>
                        <tr class="d-flex">
                            <th class="col-3 tableheading">JOURNAL REF:</th>
                            <td class="col-9"></td>
                        </tr>
                        <tr class="d-flex">
                            <th class="col-3 tableheading">AUTHORS:</th>
                            <td class="col-9"></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>
        <script>
            function onReady(callback) {
            var intervalID = window.setInterval(checkReady, 1000);
        
            function checkReady() {
                const entryPoint = fetch('http://3.128.188.117:80/plugin_poll/34a1793970dad7fcd3f6e46e2229ad57');
                entryPoint.then((response) => {
                        if (!response.ok) {
                            throw new Error("HTTP status " + response.status);
                        }
                        return response.json();
                    })
                    .then((result) => {
                        const state  = result.State;
                        console.log(state);
                        document.getElementById("state_txt").textContent = state;
                        if (state == "Done") {
                            window.clearInterval(intervalID);
                            callback.call(this);
                        }
                    })
                    .catch((e) => {
                        console.log(e);
                        window.clearInterval(intervalID);
        
                    })
            }
        }
        
        function show(id, value) {
            document.getElementById(id).style.display = value ? 'block' : 'none';
        }
        
        onReady(function () {
            show('loading', false);
            show('container1', true);
            show('container2', true)
        });
        </script>
    </body>
</html>